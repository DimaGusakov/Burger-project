\documentclass[14pt,a4paper]{extarticle}
\usepackage{mathtext}
\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{latexsym}
\usepackage{amsmath,amsthm}
\usepackage{amssymb}
\usepackage[a4paper,left=20mm,right=12mm,bottom=25mm,head=1mm]{geometry}
\usepackage{graphicx}
\graphicspath{{pictures/}}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
%\usepackage{hyperref} 
\begin{document}




\bigskip

{\hfill весна 2024}

\medskip 


\centerline{\bf 3. ДВОИЧНЫЕ И ТРОИЧНЫЕ КОДЫ}%\label{par5}} 

\medskip

%\centerline {\sf Вопросы для самоконтроля}

\centerline {\sf Индивидуальные задания}

\medskip

{\bf Задание 1.} Переведите с точностью до пяти значащих цифр после 
запятой в двоичную позиционную систему десятичное число $m$.

\begin {tabular}{lll}
$1\ldotp 1$.  $m=31{,}75$. & $1\ldotp 2$.  $m=30{{,}}74$. & $1\ldotp 3$. $m=23{,}9$ \\
$1\ldotp 4$.  $m=25{,}82$. & $1\ldotp 5$. $m=19{,}64$. & $1\ldotp 6$. $m=26{,}93$. \\
$1\ldotp 7$.  $m=21{,}87$. & $1\ldotp 8$.  $m=27{,}46$. & $1\ldotp 9$. $m=35{,}39$. \\
$1\ldotp 10$. $m=28{,}45$. & $1\ldotp 11$. $m=36{,}72$. & $1\ldotp 12$. $m=29{,}91$.\\
$1\ldotp 13$. $m=32{,}87$. & $1\ldotp 14$. $m=34{,}66$. & $1\ldotp 15$. $m=33{,}76$.\\
\end {tabular}

\medskip


{\bf Задание 2.} Для ансамбля $X=\{x_1,\ldots ,x_7\}$ постройте двоичные
коды Фано, Шеннона и Хаффмана. Найдите энтропию ансамбля и средние длины кодовых 
слов для каждого кода.

\medskip

\begin {tabular}{ll}
$2\ldotp 1$. & 
$p(x_1)=0{,}4$, $p(x_2)=0{,}2$, $p(x_3)=p(x_4)=p(x_5)=0{,}1$,\\ 
& $p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 2$.  &
$p(x_1)=0{,}4$, $p(x_2)=p(x_3)=0{,}2$, \\
& $p(x_4)=p(x_5)=p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 3$.  &
$p(x_1)=0{,}3$, $p(x_2)=0{,}2$, $p(x_3)=0{,}15$, \\
& $p(x_4)=p(x_5)=p(x_6)=0{,}1$, 
$p(x_7)=0{,}05$. \\
$2\ldotp 4$. & 
$p(x_1)=p(x_2)=0{,}25$, $p(x_3)=0{,}15$,\\
&  $p(x_4)=p(x_5)=p(x_6)=0{,}1$, $p(x_7)=0{,}05$. \\
$2\ldotp 5$. & 
$p(x_1)=p(x_2)=0{,}2$, $p(x_3)=p(x_4)=0{,}15$, \\
& $p(x_5)=p(x_6)=p(x_7)=0{,}1$. \\
$2\ldotp 6$. & 
$p(x_1)=p(x_2)=0{,}3$, $p(x_3)=0{,}15$, $p(x_4)=0{,}1$,\\
& $p(x_5)=p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 7$. & 
$p(x_1)=0{,}3$, $p(x_2)=p(x_3)=0{,}2$, $p(x_4)=p(x_5)=0{,}1$,\\
& $p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 8$.  &
$p(x_1)=0{,}5$, $p(x_2)=0{,}2$, $p(x_3)=0{,}1$, \\
& $p(x_4)=p(x_5)=p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 9$.  &
$p(x_1)=0{,}3$, $p(x_2)=0{,}2$, \\
& $p(x_3)=p(x_4)=p(x_5)=p(x_6)=p(x_7)=0{,}1$. \\
$2\ldotp 10$. & 
$p(x_1)=0{,}3$, $p(x_2)=0{,}25$, $p(x_3)=0{,}15$, \\
& $p(x_4)=p(x_5)=0{,}1$, $p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 11$. & 
$p(x_1)=0{,}35$, $p(x_2)=0{,}25$, $p(x_3)=0{,}15$, $p(x_4)=0{,}1$, \\
& $p(x_5)=p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 12$. & 
$p(x_1)=0{,}4$, $p(x_2)=p(x_3)=0{,}15$, $p(x_4)=p(x_5)=0{,}1$,\\
& $p(x_6)=p(x_7)=0{,}05$. \\
\end{tabular}

\begin {tabular}{ll}
$2\ldotp 13$. & 
$p(x_1)=0{,}55$, $p(x_2)=0{,}2$, $p(x_3)=0{,}07$,\\
& $p(x_4)=p(x_5)=p(x_6)=0{,}05$, $p(x_7)=0{,}03$. \\
$2\ldotp 14$. & 
$p(x_1)=p(x_2)=0{,}3$, $p(x_3)=p(x_4)=p(x_5)=0{,}1$,\\
& $p(x_6)=p(x_7)=0{,}05$. \\
$2\ldotp 15$. & 
$p(x_1)=0{,}4$, $p(x_2)=0{,}2$, $p(x_3)=0{,}15$, $p(x_4)=0{,}1$,\\
& $p(x_5)=p(x_6)=p(x_7)=0{,}05$. \\
\end{tabular}

\medskip

{\bf Задание 3.} Пусть $\{X,p(x)\}$ --- ансамбль из задания~2
(каждый выбирает свой вариант),
$m_i$~--- длины кодовых слов двоичного кода Хаффмана, 
соответствующего этому ансамблю. 
Найдите ансамбль $\{Y,p(y)\}$, $Y=\{y_1,\ldots ,y_7\}$,
$p(y_i)=q_i$, $i=1,\ldots ,7$, такой, что 
$H(Y)=\sum_{i=1}^7 m_i q_i$.

%\medskip 

%\begin{center}
%\begin{tabular}{|c|c|c|c|c|c|c|}
%\hline
%$Y$&$y_1$ & $y_2$ & $y_3$ & $y_4$ & $y_5$\\
%\hline
%$p(y_i)$&$q_1$ & $q_2$ & $q_3$ & $q_4$ & $q_5$\\
%\hline
%\end{tabular}
%\end{center}
%такой, что 
%$H(Y)=\sum_{i=1}^7 m_i q_i$.


\medskip

{\bf Задание 4.} Переведите с точностью до пяти значащих цифр после запятой в троичную 
систему счисления десятичное число $m$.

\begin {tabular}{lll}
$4\ldotp 1$.  $m=27{,}58$. & $4\ldotp 6$.  $m=31{,}59$. & $4\ldotp 11$. $m=32{,}78$ \\
$4\ldotp 2$.  $m=34{,}89$. & $4\ldotp 7$. $m=35{,}12$. & $4\ldotp 12$. $m=37{,}21$. \\
$4\ldotp 3$.  $m=38{,}37$. & $4\ldotp 8$.  $m=28{,}56$. & $4\ldotp 13$. $m=39{,}62$. \\
$4\ldotp 4$. $m=40{,}55$. & $4\ldotp 9$. $m=34{,}47$. & $4\ldotp 14$. $m=37{,}46$.\\
$4\ldotp 5$. $m=29{,}86$. & $4\ldotp 10$. $m=31{,}69$. & $4\ldotp 15$. $m=34{,}84$.\\
\end {tabular}

\medskip

{\bf Задание 5.} Переведите с точностью до пяти значащих цифр после запятой в двоичную 
систему счисления троичное число  $m$.

\begin {tabular}{lll}
$5\ldotp 1$.  $m=2101{,}12$. & $5\ldotp 6$.  $m=1022{,}021$. & $5\ldotp 11$. $m=1022{,}022$ \\
$5\ldotp 2$.  $m=1211{,}2111$. & $5\ldotp 7$. $m=2211{,}212$. & $5\ldotp 12$. $m=22011{,}01$. \\
$5\ldotp 3$.  $m=2012{,}102$. & $5\ldotp 8$.  $m=1222{,}202$. & $5\ldotp 13$. $m=12121{,}11$. \\
$5\ldotp 4$. $m=1121{,}201$. & $5\ldotp 9$. $m=1111{,}221$. & $5\ldotp 14$. $m=20021{,}21$.\\
$5\ldotp 5$. $m=2122{,}1102$. & $5\ldotp 10$. $m=2021{,}122$. & $5\ldotp 15$. $m=21221{,}22$.\\
\end {tabular}

%\newpage

\medskip

{\bf Задание 6.}   Для ансамбля $X=\{x_1,\ldots ,x_7\}$ постройте троичные коды Фано, Шеннона
и Хаффмана. Найдите энтропию ансамбля и средние длины кодовых слов для каждого кода.

\begin {tabular}{ll}
$6\ldotp 1$. &
$p(x_1)=p(x_2)=0{,}3,$ $p(x_3)=p(x_4)=p(x_5)=0{,}1,$ \\
& $p(x_6)=p(x_7)=0{,}05$.\\
$6\ldotp 2$. &
$p(x_1)=p(x_2)=0{,}25,$ \\
& $p(x_3)=p(x_4)=p(x_5)=p(x_6)=p(x_7)=0{,}1$.\\
$6\ldotp 3$. &
$p(x_1)=0{,}3, $ $p(x_2)=0{,}2,$ $p(x_3)=0{,}15,$ \\
& $p(x_4)=p(x_5)=p(x_6)=0{,}1, $ $p(x_7)=0{,}05$.\\
$6\ldotp 4$. &
$p(x_1)=0{,}3, $ $p(x_2)=0{,}25, $ $p(x_3)=0{,}15,$\\
& $p(x_4)=p(x_5)=0{,}1, $ $p(x_6)=p(x_7)=0{,}05$. \\
$6\ldotp 5$. &
$p(x_1)=0{,}5, $ $p(x_2)=0{,}2, $ $p(x_3)=0{,}1,$\\
& $p(x_4)=p(x_5)=p(x_6)=p(x_7)=0{,}05$.\\ 
$6\ldotp 6$. &
$p(x_1)=0{,}3, $ $p(x_2)=0{,}2,$ \\
& $p(x_3)=p(x_4)=p(x_5)=p(x_6)=p(x_7)=0{,}1$.\\
\end{tabular} 

\begin {tabular}{ll}
$6\ldotp 7$.&
$p(x_1)=0{,}4, $ $p(x_2)=p(x_3)=0{,}15,$\\
& $p(x_4)=p(x_5)=0{,}1,$ $p(x_6)=p(x_7)=0{,}05$.\\
$6\ldotp 8$. &
$p(x_1)=p(x_2)=0{,}2, $ $p(x_3)=0, $ $p(x_4)=0{,}3,$\\
& $p(x_5)=p(x_6)=p(x_7)=0{,}1$.\\ 
$6\ldotp 9$. &
$p(x_1)=0{,}55, $ $p(x_2)=0{,}2, $ $p(x_3)=0{,}07,$\\
& $p(x_4)=p(x_5)=p(x_6)=0{,}05, $ $p(x_7)=0{,}03$.\\
$6\ldotp 10$. &
$p(x_1)=0{,}3, $ $p(x_2)=p(x_3)=0{,}2,$ \\
& $p(x_4)=p(x_5)=0{,}1,$ $p(x_6)=p(x_7)=0{,}05$.\\
$6\ldotp 11$. &
$p(x_1)=p(x_2)=0{,}3,$ $p(x_3)=p(x_4)=p(x_5)=0{,}1,$\\
& $p(x_6)=p(x_7)=0{,}05$.\\
$6\ldotp 12$. &
$p(x_1)=p(x_2)=0{,}25, $ $p(x_3)=0{,}15, $\\
& $p(x_4)=p(x_5)=p(x_6)=0{,}1,$ $p(x_7)=0{,}05$.\\
$6\ldotp 13$. &
$p(x_1)=0{,}4, $ $p(x_2)=0{,}2, $ $p(x_3)=0{,}15,$\\
& $p(x_4)=0{,}1, $ $p(x_5)=p(x_6)=p(x_7)=0{,}05$.\\
$6\ldotp 14$. &
$p(x_1)=0{,}35, $ $p(x_2)=0{,}25, $ $p(x_3)=0{,}15,$\\
& $p(x_4)=0{,}1, $ $p(x_5)=p(x_6)=p(x_7)=0{,}05$.\\
$6\ldotp 15$. &
$p(x_1)=p(x_2)=0{,}3, $ $p(x_3)=0{,}15, $ \\
& $p(x_4)=0{,}1, $ $p(x_5)=p(x_6)=p(x_7)=0{,}05$.\\
\end{tabular} 

\medskip

{\bf Задание 7.} Для ансамбля $X=\{x_1,\ldots ,x_6\}$ даны двоичные кодовые слова. 
Преобразуйте слова из двоичной в троичную системы счисления. 
Сравните средние длины кодовых слов построенные в двоичных и 
троичных систем счисления. Считать что все сообщения равновероятны.

$7\ldotp 1$.
$X=\{10,100,101,110,10110,10010\}$.

$7\ldotp 2$.
$X=\{111,110,100,101,10100,11010\}$.

$7\ldotp 3$.
$X=\{100,101,1100,1010,10110,10101\}$.

$7\ldotp 4$.
$X=\{111,110,1101,1100,10111,10000\}$.

$7\ldotp 5$.
$X=\{001,000,0010,0101,01011,01001\}$.

$7\ldotp 6$.
$X=\{010,011,0101,0110,01011,01001\}$.

$7\ldotp 7$.
$X=\{11,101,1001,0011,10011,11101\}$.

$7\ldotp 8$.
$X=\{00,101,1011,0100,10000,10001\}$.

$7\ldotp 9$.
$X=\{01,110,1000,1010,00000,11010\}$.

$7\ldotp 10$.
$X=\{101,111,0000,1110,01011,11111\}$.

$7\ldotp 11$.
$X=\{11,111,1110,0100,11011,01011\}$.

$7\ldotp 12$.
$X=\{010,110,0110,1101,01111,11001\}$.

$7\ldotp 13$.
$X=\{101,011,1011,1100,10011,01101\}$.

$7\ldotp 14$.
$X=\{111,100,1011,0110,11001,01001\}$.

$7\ldotp 15$.
$X=\{10,101,1010,1010,10101,10100\}$.

\newpage

\medskip

\centerline {\sf Примеры решения задач}

\medskip

{\bf Пример 1.}  Построить двоичный код Фано для ансамбля  
$$
X=\{x_1,x_2, x_3,x_4,x_5,x_6\}, \ \ 
p(x_1)=0{,}36, \ p(x_2)=p(x_3)=0{,}18,\
$$
$$
p(x_4)=0{,}12,\ p(x_5)=0{,}09,\ p(x_6)=0{,}07.
$$

\medskip

{\sc Решение} приведено в таблице 1. 

\hfill {\sc Таблица 1.}

\bigskip

{\fontsize{15}{14}\selectfont
{\renewcommand {\arraystretch}{2,0} 
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
$X$     & $p(x_i)$  & $X^0/X^1$ & $~~X^{ij}~~~$ & $~~X^{ijk}~~~$ &  
$~~X^{ijkl}~~~$   & {код} & $m_i$\\
\hline
$x_1$   & $0{,}36$ & $0$ & $0$ &&& $00$ & $2$\\
\hline
$x_2$   & $0{,}18$ & $0$ & $1$ &&& $01$ & $2$\\
\hline
$x_3$   & $0{,}18$ & $1$ & $0$ &&&  $10$ & $2$\\
\hline
$x_4$   & $0{,}12$ & $1$ & $1$ & $0$ &&  $110$ & $3$\\
\hline
$x_5$   & $0{,}09$ & $1$ & $1$ & $1$ & $0$ &  $1110$ & $4$ \\
\hline
$x_6$   & $0{,}07$ & $1$ & $1$ & $1$ & $1$ & $1111$ & $4$ \\
\hline
\end {tabular} }}

\bigskip

Вычислим среднюю длину кодовых слов. Воспользуемся формулой 
$$
\overline  m(X)\,:\,=\sum _{x_i\in X} m_ip(x_i). 
$$
В нашем примере имеем:
$$
\overline  m(X)=2(0{,}36+ 0{,}18+0{,}18)+3\cdot 0{,}12+4(0{,}09+0{,}07)=2,44
$$
Средняя длина кодовых слов для построенного кода $\overline  m(X)=2,44$.

Вычислим энтропию ансамбля. 
$$
H(X)\,:\,=-\sum_{i-1}^{6}p(x_i)\log p(x_i)=2,37. \eqno \textcurrency
$$

%\begin{figure}[h]
%\includegraphics[scale=1.0]{fano.pdf}
%\center{\includegraphics[scale=1.0]{Fano.pdf}}
%\caption{Код Фано}
%\label{fig:image}
%\end{figure}
                          
\begin{figure}\center
\includegraphics[height=25cm]{1.jpg}%{Fano.jpg}
\caption{Код Фано}
%\label{fig:image}
\end{figure}

%\newpage

\newpage


\medskip

{\bf Пример 2.}  Постройте двоичный код Шеннона для ансамбля   
$$
X=\{x_1,x_2, x_3,x_4,x_5,x_6\},\ \
p(x_1)=0{,}36, \ p(x_2)=p(x_3)=0{,}18,\
$$
$$
p(x_4)=0{,}12,\ p(x_5)=0{,}09,\ p(x_6)=0{,}07.
$$

\medskip

{\sc Решение.} Проделаем последовательно шаги алгоритма Шеннона. 
Вычисления приведены в таблице 2.

\hfill {\sc Таблица 2.}


\medskip

{\fontsize{18}{14}\selectfont

{\renewcommand {\arraystretch}{1,5}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline  
$X$     & $p(x_i)$  & $m_i$ & $q_i$         & {код}   & {ус. код} & $m_i$\,ус \\ 
\hline
$x_1$   & $0{,}36$    & $2$   & $0{,}00$        &  $00$   & $00$ & $2$ \\
\hline
$x_2$   & $0{,}18$    & $3$   & $0{,}36=0{,}010$  & $010$   & $01$ & $2$\\
\hline
$x_3$   & $0{,}18$    & $3$   & $0{,}54=0{,}100$  & $100$   & $100$ & $3$\\
\hline
$x_4$   & $0{,}12$    & $4$   & $0{,}72=0{,}1011$ & $1011$  & $101$ & $3$\\
\hline
$x_5$   & $0{,}09$    & $4$   & $0{,}84=0{,}1101$  & $1101$ & $110$ & $3$\\
\hline
$x_6$   & $0{,}07$    & $4$   & $0{,}93=0{,}1110$  & $1110$ & $111$ & $3$\\
\hline
\end {tabular}
}
}	

\medskip
 
Находим числа $m_i$, $i=1,2,\ldots M$, исходя из неравенств:
$$
\frac {1}{2^{m_i}}\le p(x_i)< \frac {1}{2^{m_i-1}}. 
$$
$$
\frac {1}{2^{m_1}}\le 0{,}36= \frac {36}{100}<\frac {1}{2^{m_1-1}}, \ m_1=2.
$$
$$
\frac {1}{2^{m_2}}\le 0{,}18= \frac {18}{100}< \frac {1}{2^{m_2-1}}, \ m_2=m_3=2.
$$
$$
\frac {1}{2^{m_4}}\le 0{,}12= \frac {12}{100}< \frac {1}{2^{m_4-1}}, \ m_4=4.
$$
$$
\frac {1}{2^{m_5}}\le 0{,}09= \frac {9}{100}< \frac {1}{2^{m_5-1}}, \ m_5=4.
$$
$$
\frac {1}{2^{m_6}}\le 0{,}07= \frac {7}{100}< \frac {1}{2^{m_6-1}}, \ m_6=4.
$$

\medskip

\newpage

При нахождении $m_i$ можно использовать следующую таблицу интервалов.

\begin{center}
{\bf Таблица интервалов} $[\frac{1}{2^{m}}; \frac{1}{2^{m-1}})$ 
{\bf для натуральных} $m$ \\ 
\end{center}

$$%{\centerline
%\begin{table}[h]
\begin{tabular}{|c|c|}
\hline
$m$ & $[\frac{1}{2^{m}}; \frac{1}{2^{m-1}})$ \\
\hline
$1$ & $[0{,}50;1{,}00)$ \\
\hline
$2$ & $[0{,}25;0{,}50)$ \\
\hline
$3$ & $[0{,}13;0{,}25)$ \\
\hline
$4$ & $[0{,}06;0{,}13)$ \\
\hline
$5$ & $[0{,}03;0{,}06)$ \\
\hline
$6$ & $[0{,}02;0{,}03)$ \\
\hline
$7$ & $[0{,}01;0{,}02)$ \\
\hline
$8$ & $[0{,}00;0{,}01)$ \\
\hline
\end{tabular}
%\end{table}
$$%}


Находим кумулятивные вероятности по правилу 
$$
q_1=0{,}\ q_2=p(x_1), \ q_3=p(x_1)+p(x_2),\ \ldots ,\ q_M=\sum _{i=1}^{M-1}p(x_i). 
$$
$$
q_1=0{,}\ q_2=0{,}36, \ q_3=0{,}54,\ q_4=0{,}72,\
q_5=0{,}84, \ q_6=0{,}93.
$$

Находим первые после запятой $m_i$ знаков в разложении числа $q_i$ в 
двоичную дробь: $i=1,2,\ldots M$. Цифры этого разложения, стоящие после запятой, 
являются кодовым словом, соответствующим сообщению $x_i$. Ясно, что 
$q_1=0=0{,}00$.  Далее действуем по правилу перевода десятичной дроби
в двоичную.

\bigskip

\begin{tabular}{|c|c|}
\hline
$0{,}$     & $36\times 2=$  \\
\hline
$0{,}$      &  $72\times 2=$   \\
\hline
$1,$      & $44\times 2=$   \\
\hline
$0{,}$      & $88\times 2=$   \\
\hline
$1,$      & $76\times 2=$   \\
\hline
$1,$      & $52\times 2=$   \\
\hline
\end {tabular} \ \ \ $0{,}36=0{,}010$; \ \ 
\begin{tabular}{|c|c|}
\hline
$0{,}$     & $54\times 2=$  \\
\hline
$1,$      &  $08\times 2=$   \\
\hline
$0{,}$      & $16\times 2=$   \\
\hline
$0{,}$      & $32\times 2=$   \\
\hline
$0{,}$      & $64\times 2=$   \\
\hline
$1,$      & $28\times 2=$   \\
\hline
\end {tabular} \ \ \ $0{,}54=0{,}100$; 

\bigskip

%\newpage


\medskip

Вычислим среднюю длину построенного кода:
$$
\overline  m (X)=2\cdot 0{,}36+ 3(0{,}18+0{,}18)+4(0{,}12+0{,}09+0{,}07)=2,92.
$$ 

Вычислим среднюю длину построенного усеченного кода:
$$
\overline  m (X)=2(0{,}36+ 0{,}18)+3(0{,}18+0{,}12+0{,}09+0{,}07)=2,46.
$$ 
Напомним, что средняя длина кодовых слов 
кода по алгоритму Фано равна 2,44. 
\hfill $\textcurrency$ 


\bigskip

{\bf Пример 3.} Постройте двоичный код Хаффмана  для ансамбля 
из 7 сообщений, вероятности которых равны 0{,}3; 0{,}2; 0{,}15; 0{,}15; 
0{,}1; 0{,}05; 0{,}05.

\medskip

{\sc Решение.} Проделаем последовательно шаги алгоритма Хаффмана. 
Вычисления приведены в таблице 3. 

\hfill {\sc Таблица 3.}

\bigskip

{\fontsize{18}{14}\selectfont
{\renewcommand {\arraystretch}{1,5}

\begin{tabular}{|c|c|}
\hline
$x_i$&$p(x_i)$\\
\hline
$x_1$  & 0{,}3  \\
\hline
$x_2$  & 0{,}2  \\
\hline
$x_3$  & 0{,}15  \\
\hline
$x_4$  & 0{,}15  \\
\hline
$x_5$  & 0{,}1  \\
\hline
$x_6$  & 0{,}05 \\
\hline
$x_7$  & 0{,}05 \\
\hline
\end {tabular}
\hfill {$\Biggl {\updownarrow} ^1_0 $ 
\begin{tabular}{|c|c|}
\hline
{Код} & $m_i$\\
\hline
 11 & $2$ \\
\hline
 01 & $2$\\
\hline
101 & $3$\\
\hline
 100 & $3$ \\
\hline
001 & $3$\\
\hline
 0001 & $4$\\
\hline
 0000 & $4$\\
\hline
\end {tabular}
}
}
}

\medskip

Средняя длина кодовых слов равна 2,6:
$$
\overline  m(X)\,:\,=\sum _{x_i\in X} m_ip(x_i)=
$$
$$
=2(0{,}3+0{,}2)+3(0{,}15+0{,}15+0{,}1)+4(0{,}05+0{,}05)=2,6.
$$

Нижняя граница согласно теореме 11.2 равна 2{,}354:
$$
\overline  m(X)>\frac {H(X)}{\log D}=H(X)=\sum _{i=1}^7p(x_i)\log p(x_i)=
$$
$$
=0{,}3\cdot \log 0{,}3 + 0{,}2\cdot \log 0{,}2 +
+2\cdot 0{,}15\cdot \log 0{,}15 +
$$
$$
+0{,}1\cdot \log 0{,}1 + 2\cdot 0{,}05\cdot \log 0{,}05=2{,}354.
$$
Кода со средней длиной меньшей, чем 2,6, не существует.
\hfill $\textcurrency$ 

\medskip


\begin{figure}\center
\includegraphics[height=18cm]{2.jpg}%{xaf.jpg}
\caption{Код Хаффмана}
%\label{fig:image}
\end{figure}

\newpage

{\bf Пример 4.}
Пусть дан ансамбль  $\{X,p(x)\}$

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$X$ &$x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$\\
\hline
$p(x_i)$&$0{,}3$ & $0{,}3$ & $0{,}2$ & $0{,}1$ & $0{,}1$\\
\hline
\end{tabular}.
\end{center}

Пусть $m_i$ --- длины кодовых слов двоичного кода Хаффмана, 
соответствующего этому ансамблю, $i=1,\ldots ,5$. 
Найдите ансамбль $\{Y,p(y)\}$
%\medskip 

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$Y$&$y_1$ & $y_2$ & $y_3$ & $y_4$ & $y_5$\\
\hline
$p(y_i)$&$q_1$ & $q_2$ & $q_3$ & $q_4$ & $q_5$\\
\hline
\end{tabular}
\end{center}
такой, что 
$H(Y)=\sum_{i=1}^5 m_i q_i$.

\medskip

{\sc Решение.} 
Построим для ансамбля $\{X,p(x)\}$ код Хаффмана:

\medskip

\begin{tabular}{|c|c|}
\hline
$X$ & $p(x_i)$ \\
\hline
$x_1$ & $0{,}3$  \\
\hline
$x_2$ & $0{,}3$ \\ 
\hline
$x_3$ & $0{,}2$\\ 
\hline
$x_4$ & $0{,}1$ \\ 
\hline
$x_5$ & $0{,}1$ \\
\hline
\end{tabular}
{\hfill $\Biggl {\updownarrow} ^1_0 $
\begin{tabular}{|c|c|}
\hline
Код & $m_i$\\
\hline
$11$ & $2$ \\
\hline
$10$ & $2$ \\
\hline
$01$ & $2$ \\
\hline
$001$ & $3$ \\
\hline
$000$ & $3$ \\
\hline
\end{tabular}
}

\medskip

По условию задачи 
$$
H(Y)=-q_1\log{q_1}-q_2\log{q_2}-q_3\log{q_3}-q_4\log{q_4}-q_5\log{q_5}=
2q_1+2q_2+2q_3+3q_4+3q_5.
$$
Приравняем коэффициенты при соответствующих $q_i$:\\
$-\log{q_1}=2$, $-\log{q_2}=2$, $-\log{q_3}=2$,
$-\log{q_4}=3$, $-\log{q_5}=3$.
Таким образом, получаем: 
$q_1=q_2=q_3=0{,}25$, $q_4=q_5=0{,}125$.

\medskip

\noindent {\sc Ответ.} 
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$Y$&$y_1$ & $y_2$ & $y_3$ & $y_4$ & $y_5$\\
\hline
$p(y_i)$ & $0{,}25$ & $0{,}25$ & $0{,}25$ & $0{,}125$ & $0{,}125$\\
\hline
\end{tabular} \hfill \textcurrency

\medskip

{\bf Пример 5.}  Перевести с точностью до пяти значащих цифр после запятой 
в троичную систему счисления десятичное число 29{,}38.

%\medskip

{\sc Решение.} 
Для начала переведем целую часть. Для перевода целое десятичное число 
делят нацело с остатком (целочисленное деление) на 3 до тех пор, 
пока частное больше нуля. Остатки, записанные слева направо от последнего 
к первому являются целым несимметричным троичным эквивалентом целого 
десятичного числа.
%$$
%\arraycolsep=0.3em
%\begin{array}{r|r|r|rr}
%29\multicolumn{3}{r}{\hspace{2.5mm}3}\\
%\cline{2-2}
%27&\hspace{2mm}9\multicolumn{2}{r}{\hspace{1.8mm}3}\\
%\cline{1-1}\cline{3-3}
%\multicolumn{1}{r}{\hspace{1.9mm}\bf{2}}&\hspace{2mm}9&\hspace{2mm}3\multicolumn{2}{r}{\hspace{2.1mm}3}\\
%\cline{2-2}\cline{4-4}
%\multicolumn{2}{r}{\hspace{1.9mm}\bf{0}}&\hspace{2mm}3&\hspace{1mm}\bf{1}\\
%\cline{3-3}
%\multicolumn{3}{r}{\hspace{1.9mm}\bf{0}}\\
%\end{array}
%$$
$$
29=3\cdot 9+2, \  9=3\cdot 3+0,  \ 3=3\cdot 1+0, \ 1=3\cdot 0+1.
$$
Теперь, записав все остатки от последнего к первому справа налево, 
получим результат $29_{10}=1002_3$.

Переведем дробную часть десятичного числа в троичную систему счисления. 
$$
\arraycolsep=0.3em
\begin{array}{r|rrr}
0,&38\\
  &3\\
\cline{1-2}
\bf{1},&14\\
&3\\
\cline{1-2}
\bf{0},&42\\
&3\\
\cline{1-2}
\bf{1},&26\\
&3\\
\cline{1-2}
\bf{0},&78\\
&3\\
\cline{1-2}
\bf{2},&34\\
\end{array}
$$ 
Перевод дробного числа %из десятичной системы счисления в троичную 
осуществляется по следующему алгоритму:

--- дробная часть десятичной дроби умножается на основание 3;

--- в полученном произведении выделяется целая часть;

--- алгоритм завершается, если дробная часть полученного произведения 
равна нулю или если достигнута требуемая точность вычислений. Иначе вычисления 
продолжаются с первого шага.

\noindent
Сложим вместе дробную и целую части полученные ранее и получим: 

{\sc ОТВЕТ:} $29{,}38_{10}=1002{,}10102_3.$ \hfill $\textcurrency$ 

%\newpage

\medskip

{\bf Пример 6.} Перевести с точностью до пяти значащих цифр после запятой 
в двоичную систему счисления троичное число $m=2101{,}12$.

%\smallskip 

{\sc Решение.} Переведем число из троичной системы счисления в десятичную:
$m=2\cdot 3^3+1\cdot 3^2+1\cdot 3^0+1\cdot 3^{-1}+2\cdot 3^{-2}=
64{,}5555_{10}$

Дальше переводим число из десятичной в двоичную:

$m=62{,}556_{10}=111110{,}10001_2$

{\sc ОТВЕТ:} $2101{,}12_3=111110{,}10001_2$. \hfill $\textcurrency$ 

\medskip

{\bf Пример 7.}  Для ансамбля $X$  постройте троичные коды 
Фано, Шеннона и Хаффмана. Найдите энтропию ансамбля и средние длины 
кодовых слов.
$$
X=\{x_1,\ldots ,x_7\},  \ p(x_1)=0{,}4; \ p(x_2)=0{,}2;
$$
$$
p(x_3)=p(x_4)=p(x_5)=0{,}1; \ p(x_6)=p(x_7)=0{,}05.
$$

%\smallskip 

{\sc Решение.} Вычислим энтропию ансамбля:
$$
H(X)=-0{,}4\log_3 \, 0{,}4-0{,}2\log _3\, 0{,}2-3\cdot 0{,}1\log _3\, 0{,}1-
2\cdot 0{,}05\log _3\,0{,}05=
$$
$$
0{,}334+0{,}293+0{,}629+0{,}273=1{,}529.
$$

%\newpage

\bigskip 

{\bf Строим троичные коды по алгоритму Фано.}

\smallskip 
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$X$     & $p(x_i)$  &  &  & & {код} & $m_i$ \\
\hline
$x_1$   & $0{,}4$ & $0$ &&      & $0$ & $1$\\
\hline
\hline
$x_2$   & $0{,}2$ & $1$ & $0$ & & $10$ & $2$\\
\hline
$x_3$   & $0{,}1$ & $1$ & $1$ & & $11$ & $2$\\
\hline
\hline
$x_4$   & $0{,}1$ & $2$ & $0$ & & $20$ & $2$\\
\hline
$x_5$   & $0{,}1$ & $2$ & $1$ & & $21$ & $2$\\
\hline
$x_6$   & $0{,}05$ & $2$ & $2$ &$0$& $220$ & $3$ \\
\hline
$x_7$   & $0{,}05$ & $2$ & $2$ &$1$& $221$ & $3$ \\
\hline
\end {tabular}

\bigskip 


Находим среднюю длину кодовых слов: 

$\overline  m(x)=1\cdot 0{,}4+2\cdot 0{,}5+3\cdot 0{,}1=1{,}7$.

\bigskip 


%\begin{figure}[p]%\center
%\caption{Троичный код Фано}
%\includegraphics[height=12cm]{31}%{fanfan.pdf}
%%\label{fig:image}
%\end{figure}

%\pagestyle{empty}


%\begin{figure}[p]%\center
%\caption{Троичный код Фано (другой)}
%\includegraphics[height=12cm]{32}%{fanfanfan.pdf}
%%\label{fig:image}
%\end{figure}


%\newpage

{\bf Строим троичные коды по алгоритму Шеннона.}


%\smallskip 

Теперь построим код Шеннона. Находим числа $m_i$,  
исходя из неравенств:
$$
\frac {1}{3^{m_i}}\le p(x_i)< \frac {1}{3^{m_i-1}},
$$

\smallskip 

$$
\begin{tabular}{|c|c|c|c|c|}
\hline
$p(x_i)$ & $0{,}4$ & $0{,}2$ & $0{,}1$ & $0{,}05$ \\
\hline
$m_i$    & $1$     & $2$     & $3$     & $3$\\
\hline
\end {tabular}\,.
$$

\smallskip  

Находим кумулятивные вероятности:
$$
q_1=0;\ q_2=0{,}4;\ q_3=0{,}6;\ q_4=0{,}7;\ q_5=0{,}8;\ q_6=0{,}9;\ q_7=0{,}95.
$$

%\smallskip 
Находим первые после запятой $m_i$ знаков в разложении числа $i$ в троичную дробь.
Цифры этого разложения, стоящие после запятой, являются 
кодовым словом, соответствующим сообщению $x_i$.

\smallskip

$$
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$X$     & $p(x_i)$  & $m_i$ & $q_i$ & {Код} &   {Ус. код} & $m_i$\ ус.\\
\hline
$x_1$   & $0{,}4$ & $1$ & $0{,}0$ & $0$ & $0$ & $1$\\
\hline
$x_2$   & $0{,}2$ & $2$ & $0{,}4=0{,}01$ & $01$ & $01$ & $2$\\
\hline
$x_3$   & $0{,}1$ & $3$ & $0{,}6=0{,}121$ & $121$ &  $121$ & $3$\\
\hline
$x_4$   & $0{,}1$ & $3$ & $0{,}7=0{,}200$ & $200$ &  $200$ & $3$\\
\hline
$x_5$   & $0{,}1$ & $3$ & $0{,}8=0{,}210$ & $210$ &  $210$ & $3$\\
\hline
$x_6$   & $0{,}05$ & $3$ & $0{,}9=0{,}220$ & $220$ & $220$ & $3$ \\
\hline
$x_7$   & $0{,}05$ & $3$ & $0{,}95=0{,}221$ & $221$ & $221$ & $3$ \\
\hline
\end {tabular}\,.
$$

\smallskip 

Находим среднюю длину кодовых слов:

Для обычного кода $\overline  m=1\cdot0{,}4+0{,}2\cdot2+0{,}3\cdot3+
0{,}1\cdot 3=2{,}0$. 

Для усеченного $\overline  m=2{,}0$.

%\smallskip 

\bigskip 

{\bf Строим троичные коды по алгоритму Хаффмана.}


%\smallskip 

Проделаем последовательно шаги алгоритма Хаффмана. 
Вычисления приведены в таблице, См. рис.~3.

%\pagestyle{empty}

\begin{figure}[p]%\center
\caption{Троичный код Хафмана}
\includegraphics[height=12cm]{5.jpg}%{xafxaf2.pdf}
%\label{fig:image}
\end{figure}

%\pagestyle{empty}

%\smallskip 
%\centerline {
%\begin{tabular}{|c|c|}
%\hline
%$X$     & $p(x_i)$  \\
%\hline
%$x_1$   & $0{,}4$  \\
%\hline
%$x_2$   & $0{,}2$  \\
%\hline
%$x_3$   & $0{,}1$ \\
%\hline
%$x_4$   & $0{,}1$  \\
%\hline
%$x_5$   & $0{,}1$  \\
%\hline
%$x_6$   & $0{,}05$  \\
%\hline
%$x_7$   & $0{,}05$  \\
%\hline
%\end {tabular}
%\hfill {
%\begin{tabular}{|c|c|}
%\hline
%{Код} & $m_i$\\
%\hline
% $0$ & $1$\\
%\hline
% $1$ & $1$\\
%\hline
% $20$ & $2$\\
%\hline
% $21$ & $2$\\
%\hline
% $220$ & $3$\\
%\hline
% $221$ & $3$ \\
%\hline
% $222$ & $3$ \\
%\hline
%\end {tabular}}


%\smallskip 

%Средняя длина слова равна $\overline  m=0{,}6\cdot1+0{,}2\cdot2+0{,}2\cdot3=1{,}6$

\newpage

\medskip

{\bf Пример 8.} Для ансамбля $X=\{x_1,\ldots ,x_6\}$ даны двоичные 
кодовые слова. 
Преобразовать слова из двоичной в троичную системы счисления. 
Сравнить средние длины кодовых слов, построенные в двоичных и 
троичных систем 
счисления. Считать что все сообщения равновероятны.

%\smallskip 

$x_1=01$, $x_2=100$, $x_3=1111$, $x_4=0110$, $x_5=11110$, $x_6=10011$.

%\smallskip 

{\sc Решение.} Переведем коды ансамбля в десятеричную систему счисления: 
$x_1=01_2=1_{10}$, $x_2=100_2=4_{10}$, $x_3=1111_2=15_{10}$,
$x_4=0110_2=6_{10}$, $x_5=11110_2=30_{10}$, $x_6=10011_2=19_{10}$.\\
Переведем из десятичной системы счисления в троичную как в примере~5:

$x_1=1_{10}=1_3$, $x_2=4_{10}=11_3$, $x_3=15_{10}=120_3$,
$x_4=6_{10}=20_3$, $x_5=30_{10}=1010_3$, $x_6=19_{10}=201_3$.\\
Найдем средние длины кодовых слов:

%\smallskip 
для двоичной $\overline  m_2=(2+3+4+4+5+5)/6=23/6=\approx 3{,}83$.

%\smallskip 
для троичной $\overline  m_3=(1+2+3+2+4+3)/6=15/6=2{,}5$.


\medskip

\newpage


\centerline {\bf  ГЛОССАРИЙ}
\bigskip
  
\begin{figure}[h]%\center
\caption{Двоичное дерево}
\includegraphics[height=7cm]{9.jpg}%{xafxaf2.pdf}
%\label{fig:image}
\end{figure}

\newpage

\bigskip

\centerline {\bf  Двоичный код Фано}

\medskip

Роберт Марио Фано (11.11.1917--- 13.07.2016)~--- итало-американский 
программист, родился в Турине, Италия.  Фано известен работами 
в теории информации, изобрел (с Клодом Шенноном) код Шэннона-- Фано.
В начале 1960-ых, Фано был вовлечен в развитие работающих в режиме 
разделения времени компьютеров, и служил директором Массачусетского 
технологического института.
Фано независимо от Клода Шеннона изобрел ранний алгоритм сжатия 
информации и вывел неравенство Фано.


Рассмотрим код, метод построения которого предложили одновременно 
в 1948--49 годах Р. Фано и К. Шеннон, поэтому их называют кодами Фано, или 
кодами Шеннона~--~Фано. Это один из самых первых двоичных кодов.
В большинстве случаев код Фано либо оптимален, либо очень близок к 
оптимальному.


\medskip

{\bf Алгоритм Фано} сводится к последовательному выполнению 
следующих шагов:

1. Сообщения ансамбля $X=\{x_1,\ldots ,x_M\}$ упорядочиваем по убыванию 
вероятностей:
$$
p(x_1)\ge p(x_2)\ge \ldots \ge p(x_M).
$$

2. Разбиваем ансамбль $X$ на два подансамбля $X^{0}$ и $X^{1}$
с помощью некоторого порогового целого числа 
$1 \le  k^{1} \le M-1,$ так, чтобы абсолютная величина
$$
K^{1}=\big {|} \sum _{i=1}^{k^{1}}p(x_i)- \sum _{i=k^{1}+1}^Mp(x_i)
\big {|}
$$
достигала наименьшего возможного значения. Сообщениям подансамбля $X^{0}$  
приписываем 0, сообщениям подансамбля $X^{1}$  приписываем~1. 

3. Если подансамбли $X^{0}$, $X^{1}$ состоит более чем из двух сообщений, 
то разбиваем множество сообщений каждого из них на две части
$X^{00}$, $X^{01}$ и $X^{10}$, $X^{11}$, соответственно, 
с помощью пороговых целых чисел 
$$
1\le k^{11}\le k^{1}-1, \ 
k^{1}\le k^{12}\le M-1,  
$$
так, чтобы абсолютные величины
$$
K^{21}=\big {|} \sum _{i=1}^{k^{11}}p(x_i)- 
\sum _{i=k^{11}+1}^{k^{1}}p(x_i)
\big {|} , \ %\eqno (11.5)
K^{22}=\big {|} \sum _{i=k^{1}+1}^{k^{12}}p(x_i)- \sum _{i=k^{12}+1}^Mp(x_i)
\big {|} %\eqno (11.6)
$$
достигали наименьших возможных значений. Сообщениям из $X^{00}$, $X^{10}$ 
с нулевыми последними индексами приписываем 0, сообщениям из подгрупп 
$X^{01}$, $X^{11}$ с единичными последними индексами приписываем 1.
Другими словами, сообщениям из верхней части приписываем 0, а из нижней 
части~1.

Если подансамбль $X^{ij}$, $i,j\in \{0,1\}$ состоит более чем из одного
сообщения, то переходим к шагу 4. Если все подансамбли содержат по одному сообщению,
то переходим к шагу~5.

4. Если есть подансамбли, состоящие более чем из одного сообщения, то разбиваем
каждый из них на две подансамбля. Сообщениям из подансамблей с нулевыми последними 
индексами приписываем
нуль, сообщениям из подансамблей с единичными последними индексами приписываем
единицу. 

Если все образовавшиеся подансамбли состоят из одного сообщения, то переходим 
к шагу~5. 

Если есть подансамбли, состоящие более чем из одного сообщения, то
то повторяем шаг~4.

5. Если образовавшиеся подансамбли состоят из одного сообщения, то 
последовательно, начиная с первой метки, выписываем нули и единицы, 
относящиеся к каждому сообщению ансамбля~$X$.

В итоге получается двоичный префиксный код для заданного ансамбля~$X$.  

\bigskip

\centerline {\bf Двоичный код Шеннона}

\medskip


{\bf Клод Элвуд Шеннон} (англ. Claude Elwood Shannon; 
30.04.1916~--- 24.02.2001)~--- американский инженер 
и математик, его работы являются синтезом математических идей с конкретным 
анализом чрезвычайно сложных проблем их технической реализации.

Напомним следующее понятие.
Кумуляция (позднелат. cumulatio --- скопление, от лат. cumulo~--- 
накапливаю):

Кумуляция (физика) --- то же, что кумулятивный эффект: концентрация 
взрывной энергии в снаряде, гранате, бомбе и т.\,п.

Кумулята --- графическое представление ряда статистических данных, 
базы данных.

Распределение кумулятивной вероятности --- функция, показывающая 
вероятность того, что случайная переменная достигнет значения, 
меньшего или равного каждому значению, которое может принимать 
случайная переменная.

\medskip

{\bf Алгоритм Шеннона} сводится к последовательному выполнению следующих 
шагов:

1. Сообщения ансамбля $X=\{x_1,\ldots ,x_M\}$ упорядочиваем по убыванию 
вероятностей:
$$
p(x_1)\ge p(x_2)\ge \ldots \ge p(x_M).
$$

2. Находим числа $m_i$, $i=1,2,\ldots M$, исходя из неравенств:
$$
\frac {1}{2^{m_i}}\le p(x_i)< \frac {1}{2^{m_i-1}}. 
$$

3. Сопоставим каждому сообщению кумулятивную вероятность по правилу 
$$
q_1=0,\ q_2=p(x_1), \ q_3=p(x_1)+p(x_2),\ q_M=\sum _{i=1}^{M-1}p(x_i). 
$$

4. Находим первые после запятой $m_i$ знаков в разложении числа $q_i$ в 
двоичную дробь: $i=1,2,\ldots M$. Цифры этого разложения, 
стоящие после запятой, 
являются кодовым словом, соответствующим сообщению~$x_i$.


5. Если необходимо, производим операцию усечения.

\bigskip

\centerline {\bf Двоичный код Хаффмена}

\medskip

Предложенный Хаффменом алгоритм построения оптимальных неравномерных 
кодов~--- одно из самых важных достижений теории информации как с 
теоретической, так и с прикладной точек зрения. Трудно поверить, 
но этот алгоритм был придуман в 1952 г. студентом Дэвидом Хаффменом 
в процессе выполнения домашнего задания.   

\medskip

{\bf Алгоритм Хаффмана.}
1. Сообщения ансамбля $X=\{x_1,\ldots ,x_M\}$ упорядочиваем по убыванию 
вероятностей:
$$
p(x_1)\ge p(x_2)\ge \ldots \ge p(x_M).
$$

2. Два наименее вероятные сообщения склеиваем в одно и приписываем ему
суммарную вероятность склеенных сообщений.

3. Если полученный ансамбль состоит из двух или более сообщений, то 
переходим к первому пункту, т.\,е. в полученном ансамбле вероятности
упорядочиваем по убыванию. Затем два наименее вероятные сообщения склеиваем 
в одно и приписываем ему суммарную вероятность склеенных сообщений.

4. Через конечное число шагов получим ансамбль, состоящий из одного сообщения. 
 
5. Двигаясь от заключительного ансамбля к начальному и расставляя кодовые символы
0 и 1 по принципу "<вверх~---~1">, "<вниз~---~0"> получаем оптимальный код.

Алгоритм Хаффмана, в отличие от алгоритма Фано, всегда строит оптимальный 
префиксный код при любом $D\ge 2$.

\medskip
\medskip

\newpage

\bigskip
  
\begin{figure}[h]%\center
\caption{Троичное дерево}
\includegraphics[height=7cm]{7.jpg}%{xafxaf2.pdf}
%\label{fig:image}
\end{figure}

%\newpage

\medskip
\centerline {\bf  Троичный код Фано}

\medskip

{\bf Алгоритм Фано} сводится к последовательному выполнению следующих шагов:

1. Сообщения ансамбля $X=\{x_1,\ldots ,x_M\}$ упорядочиваем по убыванию
вероятностей:
$$
p(x_1)\ge p(x_2)\ge \ldots \ge p(x_M).
$$

2. Разбиваем ансамбль $X$ на три подансамбля $X^{(0)}$, $X^{(1)}$ и $X^{(2)}$
%с помощью двух пороговых целых чисел $k^{(1)}$ и $k^{(2)}$, 
%$$
%1 \le k^{(1)} < k^{(2)} \le M-1,
%$$ 
так, чтобы абсолютная величина
$$
K_1=\mid \sum _{x_i\in X^{(0)}}p(x_i)- \sum _{x_i\in X^{(1)}}p(x_i)\mid + 
\mid \sum _{x_i\in X^{(0)}}p(x_i)- \sum _{x_i\in X^{(2)}}p(x_i)\mid+ 
$$
$$
+ \mid \sum _{x_i\in X^{(1)}}p(x_i)- \sum _{x_i\in X^{(2)}}p(x_i)\mid 
$$
достигала наименьшего возможного значения. Сообщениям подансамбля $X^{(0)}$
приписываем 0, сообщениям подансамбля $X^{(1)}$  приписываем 1, 
сообщениям подансамбля $X^{(2)}$  приписываем~2.

3. Если подансамбль $X^{(0)}$ состоит из четырех и более сообщений,
то разбиваем множество его сообщений на три части
$X^{(00)}$, $X^{(01)}$ и $X^{(02)}$ таким образом, чтобы соответствующая 
абсолютная величина $K_2$, вычисленная по формуле 
$$
K_2=\mid \sum _{x_i\in X^{(00)}}p(x_i)- \sum _{x_i\in X^{(01)}}p(x_i)\mid + 
\mid \sum _{x_i\in X^{(00)}}p(x_i)- \sum _{x_i\in X^{(02)}}p(x_i)\mid+ 
$$
$$
+ \mid \sum _{x_i\in X^{(01)}}p(x_i)- \sum _{x_i\in X^{(02)}}p(x_i)\mid,
$$
достигала наименьшего возможного значения. Сообщениям из ансамбля $X^{(00)}$ 
приписываем 0, сообщениям из ансамбля $X^{(01)}$  приписываем 1, 
а сообщениям из ансамбля  $X^{(02)}$ приписываем~2.

Аналогично поступаем с ансамблями $X^{(1)}$ и $X^{(2)}$.

4. Если на каком-то этапе получаем подансамбль из четырех и более сообщений, 
то к нему применяем шаг~3.

5. Если на каком-то этапе получили подансамбль из одного, двух или трех сообщений,
то для них дописываем в кодовые слова 0, 1 и 2. Для этих подансамблей 
процесс кодирования прекращается.

В итоге получается троичный префиксный код для заданного ансамбля~$X$.

\bigskip

\centerline {\bf  Троичный код  Шеннона}

\medskip

{\bf Алгоритм Шеннона} сводится к последовательному выполнению следующих шагов:

1. Сообщения ансамбля $X=\{x_1,\ldots ,x_M\}$ упорядочиваем по убыванию
вероятностей:
$$
p(x_1)\ge p(x_2)\ge \ldots \ge p(x_M).
$$

2. Находим числа $m_i$, $i=1,2,\ldots M$, исходя из неравенств:
$$
\frac {1}{3^{m_i}}\le p(x_i)< \frac {1}{3^{m_i-1}}.
$$

3. Сопоставим каждому сообщению кумулятивную вероятность по правилу:
$$
q_1=0,\ q_2=p(x_1), \ q_3=p(x_1)+p(x_2),\ q_M=\sum _{i=1}^{M-1}p(x_i). 
$$

4. Находим первые после запятой $m_i$ знаков в разложении числа $q_i$ в
троичную дробь: $i=1,2,\ldots M$. Цифры этого разложения, стоящие после запятой,
являются кодовым словом, соответствующим сообщению~$x_i$.

5. Если необходимо, производим операцию усечения.

\medskip

\centerline {\bf Троичный код Хаффмена}

\medskip

1. Сообщения ансамбля $X=\{x_1,\ldots ,x_M\}$ упорядочиваем по убыванию
вероятностей:
$$
p(x_1)\ge p(x_2)\ge \ldots \ge p(x_M).
$$

2. Три наименее вероятные сообщения склеиваем в одно и приписываем ему
суммарную вероятность склеенных сообщений.

3. Если полученный ансамбль состоит из трех или более сообщений, то
переходим к первому и второму пунктам, т.\,е. в полученном ансамбле вероятности
упорядочиваем по убыванию. Затем три наименее вероятные сообщения склеиваем
в одно и приписываем ему суммарную вероятность склеенных сообщений.

4. Через конечное число шагов получим ансамбль, состоящий из одного или двух сообщения.

5. Двигаясь от заключительного ансамбля к начальному и расставляя кодовые символы
0, 1 и 2 по принципу "<вверх~---~1">, "<вниз~---~0"> и "<центр~---~2"> 
получаем оптимальный код.


\end{document}

